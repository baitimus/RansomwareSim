flowchart TD
    A[Start: ransomware_sim.ps1] --> B[Load Configuration]
    B --> C[Test Prerequisites]
    C --> D{Prerequisites OK?}
    D -->|No| E[Error: Missing AES Module] --> Z[Exit]
    D -->|Yes| F[Import AES Module]
    F --> G[Initialize Environment]
    G --> H[Show Main Menu]
    H --> I{User Selection}
    I -->|1| J[Encryption Simulation]
    I -->|2| K[Restore Files]
    I -->|3| L[System Status]
    I -->|4| M[View Logs]
    I -->|5| N[Open Backup Folder]
    I -->|6| O[Health Check]
    I -->|7| P[About/Help]
    I -->|0| Q[Exit] --> Z
    
    J --> H
    K --> H
    L --> H
    M --> H
    N --> H
    O --> H
    P --> H
    
    classDef startEnd fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef process fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef decision fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef error fill:#ffcdd2,stroke:#d32f2f,stroke-width:2px
    
    class A,Z startEnd
    class B,C,F,G,H process
    class D,I decision
    class E error