flowchart TD
    A[Start Restore] --> B[Check Backup Folder]
    B --> C{Backup Exists?}
    C -->|No| D[Error: No Backup] --> Z[Return to Menu]
    C -->|Yes| E[Scan Encrypted Files]
    E --> F[Show Restore Info]
    F --> G{User Confirms?}
    G -->|No| H[Cancel] --> Z
    G -->|Yes| I[Remove Encrypted Files]
    I --> J[Process Each Backup]
    J --> K[Copy to Desktop]
    K --> L{More Backups?}
    L -->|Yes| J
    L -->|No| M[Remove Ransom Note]
    M --> N[Show Results]
    N --> Z
    
    classDef process fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef decision fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef error fill:#ffcdd2,stroke:#d32f2f,stroke-width:2px
    classDef warning fill:#fff8e1,stroke:#f57f17,stroke-width:2px
    
    class A,B,E,F,I,J,K,M,N process
    class C,G,L decision
    class D error
    class H warning